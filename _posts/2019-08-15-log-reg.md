---
layout: post
title: "Logistic Regression Model for document categorization         (Python, Natural Language Processing)"
date: 2019-08-17
---
Used a logistic regression model and natural language processing packages to write a script in Python that automatically buckets
survey open-response submissions into one of fourteen unique categories.

![alt text](https://placekitten.com/300/300 "Text Title")

![classic_banner]({{ site.url }}/assets/ragnaros.jpg){:height="50%" width="50%"}

Import packages

```python
import pandas as pd
import numpy as np
import string

from sklearn.naive_bayes import MultinomialNB
from sklearn.linear_model import LogisticRegression
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
```


Read in the data then pull the documents (responses) and labels (categories)
from the data frame.

Data (where "Other" are the responses):

```python
Data columns (total 3 columns):
id                                                 2617 non-null int64
Other                                              2038 non-null object
Category                                           2039 non-null float64
```

Read in the data:

```python
df = pd.read_csv('test_data1.csv')
df_responses_categories = df[['Other', 'Category']].dropna(how='any').reset_index(drop=True)

responses = df_responses_categories['Other'].apply(remove_punctuations).str.lower()
categories = df_responses_categories['Category']

print(df.info)
```

Split the data into a training and test set.

```python
responses = list(responses)
categories = list(categories)

test_size = 0.20

train_responses, test_responses, train_categories, test_categories = train_test_split(
        responses, categories, test_size = test_size, random_state = 102)
```
